{"version":3,"file":"2-form.js","sources":["../src/js/2-form.js"],"sourcesContent":["import validator from 'validator';\n\nconst feedbackFormEl = document.querySelector('.feedback-form');\n\nlet formData = { email: '', message: '' };\nconst formLSKey = 'feedback-form-state';\n\ninitFormState();\n\nfeedbackFormEl.addEventListener('input', handleFormElInput);\nfeedbackFormEl.addEventListener('submit', handleFormElSubmit);\n\n//!======================================================\nfunction initFormState() {\n  const data = getDataFromLS(formLSKey);\n\n  try {\n    if (data && typeof data === 'object') {\n      formData.email = data.email || '';\n      formData.message = data.message || '';\n\n      const { email: emailEl, message: messageEl } = getFormElements();\n      if (emailEl && messageEl) {\n        emailEl.value = formData.email;\n        messageEl.value = formData.message;\n      }\n    }\n  } catch (error) {\n    console.warn('Failed to parse LS or restore form state', error);\n  }\n}\n\nfunction handleFormElInput(e) {\n  removeError();\n  const { name, value } = e.target;\n  if (!(name in formData)) return;\n  formData[name] = value;\n  setDataToLs(formLSKey, formData);\n}\n\nfunction handleFormElSubmit(e) {\n  e.preventDefault();\n  const email = formData.email.trim();\n  const message = formData.message.trim();\n\n  const isValidEmail = validator.isEmail(email);\n  const isEmptyEmail = email.length === 0;\n  const isEmptyMessage = message.length === 0;\n\n  if (!isEmptyEmail && !isValidEmail) {\n    showError('Invalid email');\n    return;\n  } else if (isEmptyEmail || isEmptyMessage) {\n    showError('Fill please all fields');\n    return;\n  }\n  formData.email = email;\n  formData.message = message;\n  console.log(formData);\n  resetForm(feedbackFormEl);\n}\n\n//!======================================================\nfunction getFormElements() {\n  const { email, message } = feedbackFormEl.elements;\n  return { email, message };\n}\n\nfunction showError(errorText) {\n  if (feedbackFormEl.querySelector('.form-error-message')) return;\n  const errorMessageElem = `<p class=\"form-error-message\">${errorText}</p>`;\n  feedbackFormEl.insertAdjacentHTML('beforeend', errorMessageElem);\n}\n\nfunction removeError() {\n  const oldErrorMessage = feedbackFormEl.querySelector('.form-error-message');\n  if (oldErrorMessage) oldErrorMessage.remove();\n}\n\nfunction resetForm(formEl) {\n  removeError();\n\n  formEl.reset();\n  formData = { email: '', message: '' };\n  localStorage.removeItem(formLSKey);\n}\n\n//!======================================================\nfunction setDataToLs(key, data) {\n  const jsonObj = JSON.stringify(data);\n  localStorage.setItem(key, jsonObj);\n}\n\nfunction getDataFromLS(key, defaultValue = {}) {\n  const jsonData = localStorage.getItem(key);\n  try {\n    return jsonData ? JSON.parse(jsonData) : defaultValue;\n  } catch (error) {\n    console.warn('Failed to parse localStorage:', error);\n    return defaultValue;\n  }\n}\n"],"names":["feedbackFormEl","formData","formLSKey","initFormState","handleFormElInput","handleFormElSubmit","data","getDataFromLS","emailEl","messageEl","getFormElements","error","removeError","name","value","setDataToLs","email","message","isValidEmail","validator","isEmptyEmail","isEmptyMessage","showError","resetForm","errorText","errorMessageElem","oldErrorMessage","formEl","key","jsonObj","defaultValue","jsonData"],"mappings":"wIAEA,MAAMA,EAAiB,SAAS,cAAc,gBAAgB,EAE9D,IAAIC,EAAW,CAAE,MAAO,GAAI,QAAS,EAAE,EACvC,MAAMC,EAAY,sBAElBC,IAEAH,EAAe,iBAAiB,QAASI,CAAiB,EAC1DJ,EAAe,iBAAiB,SAAUK,CAAkB,EAE5D;AACA,SAASF,GAAgB,CACvB,MAAMG,EAAOC,EAAcL,CAAS,EAEpC,GAAI,CACF,GAAII,GAAQ,OAAOA,GAAS,SAAU,CACpCL,EAAS,MAAQK,EAAK,OAAS,GAC/BL,EAAS,QAAUK,EAAK,SAAW,GAEnC,KAAM,CAAE,MAAOE,EAAS,QAASC,CAAS,EAAKC,IAC3CF,GAAWC,IACbD,EAAQ,MAAQP,EAAS,MACzBQ,EAAU,MAAQR,EAAS,QAE9B,CACF,OAAQU,EAAO,CACd,QAAQ,KAAK,2CAA4CA,CAAK,CAC/D,CACH,CAEA,SAASP,EAAkB,EAAG,CAC5BQ,IACA,KAAM,CAAE,KAAAC,EAAM,MAAAC,GAAU,EAAE,OACpBD,KAAQZ,IACdA,EAASY,CAAI,EAAIC,EACjBC,EAAYb,EAAWD,CAAQ,EACjC,CAEA,SAASI,EAAmB,EAAG,CAC7B,EAAE,eAAc,EAChB,MAAMW,EAAQf,EAAS,MAAM,KAAI,EAC3BgB,EAAUhB,EAAS,QAAQ,KAAI,EAE/BiB,EAAeC,EAAU,QAAQH,CAAK,EACtCI,EAAeJ,EAAM,SAAW,EAChCK,EAAiBJ,EAAQ,SAAW,EAE1C,GAAI,CAACG,GAAgB,CAACF,EAAc,CAClCI,EAAU,eAAe,EACzB,MACJ,SAAaF,GAAgBC,EAAgB,CACzCC,EAAU,wBAAwB,EAClC,MACD,CACDrB,EAAS,MAAQe,EACjBf,EAAS,QAAUgB,EACnB,QAAQ,IAAIhB,CAAQ,EACpBsB,EAAUvB,CAAc,CAC1B,CAEA;AACA,SAASU,GAAkB,CACzB,KAAM,CAAE,MAAAM,EAAO,QAAAC,GAAYjB,EAAe,SAC1C,MAAO,CAAE,MAAAgB,EAAO,QAAAC,EAClB,CAEA,SAASK,EAAUE,EAAW,CAC5B,GAAIxB,EAAe,cAAc,qBAAqB,EAAG,OACzD,MAAMyB,EAAmB,iCAAiCD,CAAS,OACnExB,EAAe,mBAAmB,YAAayB,CAAgB,CACjE,CAEA,SAASb,GAAc,CACrB,MAAMc,EAAkB1B,EAAe,cAAc,qBAAqB,EACtE0B,GAAiBA,EAAgB,QACvC,CAEA,SAASH,EAAUI,EAAQ,CACzBf,IAEAe,EAAO,MAAK,EACZ1B,EAAW,CAAE,MAAO,GAAI,QAAS,EAAE,EACnC,aAAa,WAAWC,CAAS,CACnC,CAEA;AACA,SAASa,EAAYa,EAAKtB,EAAM,CAC9B,MAAMuB,EAAU,KAAK,UAAUvB,CAAI,EACnC,aAAa,QAAQsB,EAAKC,CAAO,CACnC,CAEA,SAAStB,EAAcqB,EAAKE,EAAe,GAAI,CAC7C,MAAMC,EAAW,aAAa,QAAQH,CAAG,EACzC,GAAI,CACF,OAAOG,EAAW,KAAK,MAAMA,CAAQ,EAAID,CAC1C,OAAQnB,EAAO,CACd,eAAQ,KAAK,gCAAiCA,CAAK,EAC5CmB,CACR,CACH"}